{% extends "static.html" %}

{% block content %}
    <h1 class="page-title">Matomo API Status</h1>
    <div class="page-content">
        <table class="datatable table table-condensed table-hover">
            <thead>
                <tr>
                    <th></th>
                    <th style="text-align: center">Date</th>
                    <th style="text-align: center">Time</th>
                    <th style="text-align: center">Total Rows</th>
                    <th style="text-align: center">Error Message</th>
                </tr>
            </thead>
            <tbody>
                {% for call in api_calls %}
                <tr>
                    <td style="text-align: center">
                        <span class="status-indicator"
                              style="background-color: {% if call.status_code == 200 %}green{% else %}red{% endif %}"
                              data-toggle="tooltip"
                              title="{{ call.status }}">
                        </span>
                    </td>
                    <td style="text-align: center">{{ call.timestamp.strftime("%d-%m-%Y") }}</td>
                    <td style="text-align: center">{{ call.timestamp.strftime("%H:%M:%S") }}</td>
                    <td style="text-align: right">{{ call.total_rows_found }}</td>
                    <td style="text-align: center">
                        {% if call.error_message %}
                            <span data-toggle="tooltip" title="{{ call.error_message }}">
                                {{ call.error_message[:16] }}{% if call.error_message|length > 16 %}...{% endif %}
                            </span>
                        {% else %}
                            None
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
{% endblock %}
