{% extends "static.html" %}

{% block content %}
    <h1 class="page-title">Matomo API Status</h1>
    <div class="page-content">
        <table class="datatable display" style="width: 100%; margin-top: 20px;">
            <thead>
                <tr>
                    <th style="border: 1px solid #ddd; padding: 8px;">Timestamp</th>
                    <th style="border: 1px solid #ddd; padding: 8px;">Status</th>
                    <th style="border: 1px solid #ddd; padding: 8px;">Total Rows</th>
                    <th style="border: 1px solid #ddd; padding: 8px;">Error Message</th>
                </tr>
            </thead>
            <tbody>
                {% for call in api_calls %}
                <tr>
                    <td style="border: 1px solid #ddd; padding: 8px;">{{ call.timestamp.strftime("%d-%m-%Y") }}</td>
                    <td style="border: 1px solid #ddd; padding: 8px;">
                        {{ call.status_code }}
                        <span class="status-indicator"
                              style="display: inline-block; width: 10px; height: 10px; border-radius: 50%;
                                     background-color: {% if call.status_code == 200 %}green{% else %}red{% endif %}; margin-left: 10px;">
                        </span>
                    </td>
                    <td style="border: 1px solid #ddd; padding: 8px;">{{ call.total_rows }}</td>
                    <td style="border: 1px solid #ddd; padding: 8px;">{{ call.error_message }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
{% endblock %}
